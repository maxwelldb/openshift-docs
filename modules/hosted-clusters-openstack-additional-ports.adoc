// Module included in the following assemblies:
//
// * hosted_control_planes/hypershift-openstack.adoc

:_mod-docs-content-type: PROCEDURE
[id="hosted-clusters-openstack-additional-ports_{context}"]
= Configuring additional ports for node pools

You can configure additional ports for node pools to support advanced networking scenarios, such as SR-IOV or multiple networks.

== Use cases for additional ports for node pools

* **SR-IOV (Single Root I/O Virtualization)**: Enables a physical network device to appear as multiple virtual functions (VFs). By attaching additional ports to node pools, workloads can use SR-IOV interfaces to achieve low-latency, high-performance networking.

* **DPDK (Data Plane Development Kit)**: Provides fast packet processing in user space, bypassing the kernel. Node pools with additional ports can expose interfaces for workloads that use DPDK to improve network performance.

* **Manila RWX volumes on NFS**: Supports `ReadWriteMany` (RWX) volumes over NFS, allowing multiple nodes to access shared storage. Attaching additional ports to node pools enables workloads to reach the NFS network used by Manila.

* **Multus CNI**: Enables pods to connect to multiple network interfaces. Node pools with additional ports support use cases that require secondary network interfaces, including dual-stack connectivity and traffic separation.


== Options for additional ports for node pools

The --openstack-node-additional-port flag can be used to attach additional ports to nodes in a HostedCluster on OpenStack. The flag takes a list of parameters separated by commas. The parameter can be used multiple times to attach multiple additional ports to the nodes.

The parameters are:

|===
|Parameter|Description|Required|Default

|`network-id`
|The ID of the network to attach to the node.
|Yes
|N/A

|`vnic-type`
|The VNIC type to use for the port. If not specified, Neutron uses the default type `normal`.
|No
|N/A

|`disable-port-security`
|Whether to disable port security for the port. If not specified, Neutron enables port security unless it is explicitly disabled at the network level.
|No
|N/A

|`address-pairs`
|A list of IP address pairs to assign to the port. The format is `ip_address=mac_address`. Multiple pairs can be provided, separated by a hyphen (`-`). The `mac_address` portion is optional.
|No
|N/A
|===

== Creating additional ports for node pools

You can configure additional ports for node pools for hosted clusters that run on {rh-openstack-first}.

.Prerequisites

* You created a hosted cluster.
* You have access to the management cluster.
* The `hcp` CLI is installed.
* Additional networks are created in {rh-openstack}.
* The project that is used by the hosted cluster must have access to the additional networks.
* You reviewed the options that are listed in "Options for additional ports for node pools".

.Procedure

* Create a hosted cluster with additional ports attached to it by running the `hcp create nodepool openstack` command with the `--openstack-node-additional-port` options. For example:
+
[source,terminal]
----
$ hcp create nodepool openstack \
  --cluster-name <cluster_name> \
  --name <nodepool_name> \
  --replicas <replica_count> \
  --openstack-node-flavor <flavor> \
  --openstack-node-additional-port "network-id=<sriov_net_id>,vnic-type=direct,disable-port-security=true" \
  --openstack-node-additional-port "network-id=<lb_net_id>,address-pairs:192.168.0.1-192.168.0.2"
----
+
--
where:

`<cluster_name>`:: Specifies the name of the hosted cluster.
`<nodepool_name>`:: Specifies the name of the node pool.
`<replica_count>`:: Specifies the desired number of replicas.
`<flavor>`:: Specifies the {rh-openstack} flavor to use.
`<sriov_net_id>`:: Specifies a SR-IOV network ID.
`<lb_net_id>`:: Specifies a load balancer network ID.
--